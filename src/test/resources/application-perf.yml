spring:
  datasource:
    url: jdbc:h2:mem:perfdb;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=FALSE
    driver-class-name: org.h2.Driver
    username: sa
    password:

  jpa:
    show-sql: false
    hibernate:
      ddl-auto: create-drop
    properties:
      hibernate:
        format_sql: false

  flyway:
    enabled: false

# Plaid API credentials and base-url are resolved from env vars by application.yml:
#   PLAID_API_BASE_URL, PLAID_API_KEY, PLAID_CLIENT_ID
# Extend timeouts to accommodate real network latency to the dev API.
plaid:
  api:
    timeout:
      connection: 10000
      request: 30000

# Resilience4j tuned for high throughput - avoid tripping on load test traffic
resilience4j:
  circuitbreaker:
    instances:
      plaidApi:
        sliding-window-size: 1000
        minimum-number-of-calls: 500
        failure-rate-threshold: 80
        wait-duration-in-open-state: 60s
        permitted-number-of-calls-in-half-open-state: 100
        automatic-transition-from-open-to-half-open-enabled: true

  retry:
    instances:
      plaidApi:
        max-attempts: 1  # No retries during perf test - keep metrics clean

  bulkhead:
    instances:
      plaidApi:
        max-concurrent-calls: 200
        max-wait-duration: 10s

  thread-pool-bulkhead:
    instances:
      plaidApi:
        max-thread-pool-size: 200
        core-thread-pool-size: 100
        queue-capacity: 1000
        keep-alive-duration: 30s

springdoc:
  swagger-ui:
    enabled: false
  api-docs:
    enabled: false

management:
  endpoint:
    health:
      show-details: never

logging:
  level:
    root: WARN
    com.plaid.enrich: WARN
    org.hibernate: WARN
    io.github.resilience4j: WARN
